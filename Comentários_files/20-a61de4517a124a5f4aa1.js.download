(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{Dr7i:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var i=s("zYa8"),a=s("UxPl");const r="ultra.components.directives.bbUiIcon.small.Started";Object(i.a)(a.a,r,"bbUiIconSmallStarted")},H9hP:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var i=s("zYa8"),a=s("ULah");const r="ultra.components.directives.bbUiIcon.small.Complete";Object(i.a)(a.a,r,"bbUiIconSmallComplete")},NIxw:function(e,t){e.exports='<div bb-load-bundle="course/grades/peerReviewStatus" class="peer-review-detail" ng-class="{\'text-alert-ax\': peerReviewStatus.shouldMarkLate }">\n    <div ng-if="peerReviewStatus.hasCompletedPeerReviews"\n         ng-switch on="peerReviewStatus.hasCompletedAllPeerReviews"\n         ng-class="{\n          \'complete\': peerReviewStatus.hasCompletedAllPeerReviews,\n          \'started\': !peerReviewStatus.hasCompletedAllPeerReviews && !peerReviewStatus.hasPassedPeerReviewPeriod,\n          \'late\': !peerReviewStatus.hasCompletedAllPeerReviews && peerReviewStatus.hasPassedPeerReviewPeriod\n        }"\n        class="peer-review-detail-icon"\n    >\n      <bb-ui-icon-small-complete ng-switch-when="true" class="completed"></bb-ui-icon-small-complete>\n      <bb-ui-icon-small-started ng-switch-default class="started"></bb-ui-icon-small-started>\n    </div>\n  <span class="peer-review-detail-text">{{peerReviewStatus.peerReviewActivityLabel}}</span>\n</div>\n'},ap1t:function(e,t,s){"use strict";var i=s("D57K"),a=s("Llzl"),r=s("nsO7"),o=s("d8yC"),l=s("en1n"),c=s("0JpG"),n=s("Fvsw"),d=s("X/qj"),p=s("yMoE"),h=s("pjml"),u=s("TnpK"),m=s("g66W"),v=s("fYJU"),b=s("ooAF"),g=s("nmzr"),w=s("zGdY"),S=s("aHpC"),y=s("qH3X");s.d(t,"a",(function(){return R}));const R="ultra.components.directives.grade.displayGradePill",P="--",C="na";let I=class{constructor(e,t,s,i,a,r,o,c,n){this.$injector=e,this.$sce=t,this.scope=s,this.element=i,this.bbLocalize=a,this.context=r,this.ultraState=o,this.gradebookPermissionService=c,this.contextUser=n;const d=this.scope.column()&&this.scope.column().courseId;this.bundlePromise=a.loadBundle("components/directives/grade/display-grade"),this.canViewGradebook=this.hasViewGradebook(d),this.isStudent=n.userModel.isStudent(),this.isInstructor=n.userModel.isInstructor(),this.canViewGrades=this.hasViewGrades(d),this.canViewGrades?(this.scope.$watch("::column()",(e=>{if(e){this.scope.$watchGroup(["column()","attempt()","grade()"],(()=>{this.scope.grade&&this.scope.grade();this.createGradeDisplayItem(this.scope).then((e=>{this.gradeDisplayItem=e,this.setFullDisplayValue()}))}))}})),this.scope.$watch((()=>l.g()),(()=>{this.displayValue&&this.setFullDisplayValue()}))):this.displayValue=P,s.$on(y.a.REFRESH_OVERALL_EDITOR,(()=>{this.gradeDisplayItem.displayValue||this.shouldShowPendingForGrade()||this.shouldShowPendingForAttempt()||this.setNoSubmitView()}))}hasViewGradebook(e){return this.gradebookPermissionService.canView(e)}hasViewGrades(e){return this.isStudent||this.gradebookPermissionService.canViewGrades(e)}shouldShowPendingForGrade(){const e=this.scope.grade;return e&&e()&&!e().isPosted()&&e().hasAttempts()}shouldShowPendingForAttempt(){const e=this.scope.attempt;return e&&e()&&e().isNeedsGrading()}shouldRenderInlineRubric(){const e=this.scope.grade;return this.rubricEvaluationIsComplete()||this.shouldShowPendingForGrade()||this.shouldShowPendingForAttempt()||e().isPastDueZero()}shouldShowExempt(){var e;const t=this.scope.grade;return!!(null===(e=null==t?void 0:t())||void 0===e?void 0:e.isExempt)}isCurrentUserGrader(){return this.contextUser.userModel.memberships.every((e=>e.role===w.V.Grader))}setNoSubmitView(){this.schema&&this.scaleType&&(this.scaleType===w.ac.Percent?this.displayValue="-- %":this.scaleType!==w.ac.Score||this.shouldShowExempt()?this.displayValue=P:this.bundlePromise.then((()=>{var e,t,s,i,a,r;const l=null===(e=this.scope)||void 0===e?void 0:e.grade(),c=null!=(null==l?void 0:l.manualGrade)?l.pointsPossible:null===(s=null===(t=this.scope)||void 0===t?void 0:t.column())||void 0===s?void 0:s.possible,n=null!==(r=null!=c?c:null===(a=null===(i=this.scope)||void 0===i?void 0:i.column())||void 0===a?void 0:a.possible)&&void 0!==r?r:0;this.displayValue=P+this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.display-grade.total",params:{total:o.b(n,2)},noWrap:!0})})))}get colorClass(){return this.canViewGrades?this.gradeDisplayItem?this.gradeDisplayItem.displayValue||this.shouldShowExempt()?this.gradeDisplayItem.getGradeColor():this.isStudent?this.shouldShowPendingForGrade()||this.shouldShowPendingForAttempt()?"na pending":"na no-attempt":"":"":C}setFullDisplayValue(){if(this.displayValue=this.gradeDisplayItem&&this.gradeDisplayItem.displayValue,this.gradeDisplayItem.displayValue)this.shouldShowPossiblePoints()&&this.isSchemaTypeScore()?this.bundlePromise.then((()=>{this.displayValue=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.display-grade.score",params:{grade:this.gradeDisplayItem.displayValue,possible:o.b(this.scope.grade&&this.scope.grade().pointsPossible||this.scope.column().possible,2)},noWrap:!0,noEscape:!0})})):this.isDiscussionOrJournal()||this.isSchemaTypeLetterOrPercentage()?this.displayValue=this.shouldShowPossiblePoints()||!this.shouldShowExempt()||this.isSchemaTypeLetterOrPercentage()?this.gradeDisplayItem.displayValue:P:this.displayValue=this.shouldShowExempt()&&!this.scope.column().isScorm()?P:this.gradeDisplayItem.displayValue;else if(this.shouldShowExempt())this.displayValue=P;else if(this.isStudent&&(this.shouldShowPendingForGrade()||this.shouldShowPendingForAttempt()))this.bundlePromise.then((()=>{this.displayValue=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.display-grade.pending-grade",noWrap:!0})}));else{this.shouldShowExempt()&&this.gradeDisplayItem.getGradeColor();this.setNoSubmitView()}}get isStacked(){return!!this.scope.displayStacked}get cursorClass(){return this.scope.cursor?`cursor-${this.scope.cursor}`:""}isSchemaTypeLetterOrPercentage(){return this.scaleType===w.ac.Percent||this.scaleType===w.ac.Tabular}isSchemaTypeScore(){return this.scaleType===w.ac.Score}isDiscussionOrJournal(){return this.scope.column().isDiscussion()||this.scope.column().isJournal()}shouldShowPossiblePoints(){var e,t,s,i;return this.shouldShowExempt()?(null===(t=null===(e=this.scope.grade())||void 0===e?void 0:e.displayGrade)||void 0===t?void 0:t.isOverride)||(null===(i=null===(s=this.scope.grade())||void 0===s?void 0:s.displayGrade)||void 0===i?void 0:i.scoredByAutomaticZero)||this.gradeDisplayItem.shouldShowTotalPoints():!this.isSmallBP()&&this.gradeDisplayItem&&!r.isNaN(parseFloat(this.gradeDisplayItem.displayValue))&&this.gradeDisplayItem.shouldShowTotalPoints()}isSmallBP(){return l.a.Small===l.f()}shouldShowRubricButton(){var e,t,s;return!(this.scope.hideRubricIcon||!this.scope.column()||!this.scope.column().hasRubricAssociation())&&(!!this.isDiscussionOrJournal()||(null!=this.scope.attempt||!(!this.scope.column().isSingleAttempt()||w.l.InProgress===(null===(s=null===(t=null===(e=this.scope.grade())||void 0===e?void 0:e.ui)||void 0===t?void 0:t.attempt)||void 0===s?void 0:s.status))))}rubricEvaluationIsComplete(){const e=this.scope.column();if(e&&e.hasRubricAssociation()){const t=this.scope.attempt?this.scope.attempt():this.scope.grade().ui.attempt;return e.getRubricAssociation().isWithEvaluations&&(t&&t.isCompleted()||e.isDiscussion()||e.isJournal())}return!1}openRubricEvaluation(e){if(this.scope.disableRubricEvalClick&&this.scope.disableRubricEvalClick())return;e.stopPropagation();const t=this.getRubricStateRef();this.ultraState.current.name.endsWith("peek.assessment-submission-feedback")&&this.ultraState.leavePeekState(this.ultraState.current.name),this.ultraState.goPeekState(t.state,t.args)}getRubricStateRef(){var e;let t,s;(this.scope.grade||this.scope.attempt)&&(this.scope.attempt&&(t=null!==(e=this.scope.attempt().groupAttemptId)&&void 0!==e?e:this.scope.attempt().id),this.scope.grade&&this.scope.grade().ui&&this.scope.grade().ui.attempt&&this.scope.grade().ui.attempt.id&&(t=this.scope.grade().ui.attempt.id||this.scope.grade().ui.attempt.groupAttemptId),s=this.scope.attempt?this.scope.attempt().groupId:null,this.scope.grade&&this.scope.grade().ui.groupAttempt&&(s=this.scope.grade().ui.groupAttempt.groupId));const i={state:"",args:{attemptId:t||null,columnId:this.scope.column().id||null,contentId:this.scope.column().contentId||null,courseId:this.scope.column().courseId}};let a="inline-rubric";if(this.scope.isManualStatusPosted||this.gradeDisplayItem.displayValue&&"0"!==this.gradeDisplayItem.displayValue||this.scope.isExternalSubmission||this.scope.column().isCollectExternalSubmissions()||(a=this.shouldRenderInlineRubric()?"inline-rubric":"peek.rubric-view"),this.canViewGradebook||this.isDiscussionOrJournal()){const e=this.rubricEvaluationIsComplete()?"rubric-evaluation":"rubric-view";i.args.groupId=s||null,i.args.userId=this.scope.grade&&this.scope.grade().user&&(this.scope.grade().user.$pk||this.scope.grade().user.id)||null,i.state=e,this.scope.column().isJournal()&&(i.state=this.rubricEvaluationIsComplete()?g.B.JOURNAL_VIEW_WITH_PARTICIPATION_AND_RUBRIC_EVALUATION:g.B.JOURNAL_VIEW_WITH_PARTICIPATION_AND_RUBRIC_VIEW)}else i.args.groupId=s||null,i.state=`${g.c.ASSESSMENT_ATTEMPT_REVIEW}.${a}`;return m.d(this.ultraState.current.name,".peek.course.grades")&&(this.scope.column().isCollectExternalSubmissions()?(i.state=`${g.c.ASSESSMENT_ATTEMPT_REVIEW}.inline-rubric`,i.args.skipTransitionEvents=!0):i.state="assessment.overview"),i}createGradeDisplayItem(e){const t=this.scope.grade&&this.scope.grade(),s=this.$injector.instantiate(p.a,{gradeDetail:t,scope:e});return s.init(this.scope.column()).then((()=>{let e;return this.schema=s.schema,this.schema&&(this.scaleType=s.schema.scaleType),this.scope.attempt?e=this.scope.attempt().displayGrade:t&&this.schema&&(e=t.displayGrade),s.displayGrade=e,s}))}};I=Object(i.a)([Object(i.c)(0,Object(S.b)("$injector")),Object(i.c)(1,Object(S.b)("$sce")),Object(i.c)(2,Object(S.b)("scope")),Object(i.c)(3,Object(S.b)("element")),Object(i.c)(4,Object(S.b)(c.serviceName)),Object(i.c)(5,Object(S.b)(n.b)),Object(i.c)(6,Object(S.b)(u.d)),Object(i.c)(7,Object(S.b)(d.b)),Object(i.c)(8,Object(S.b)(v.b))],I);class E{constructor(e){this.$injector=e,this.restrict="E",this.template=b,this.scope={attempt:"&?",column:"&",disableRubricEvalClick:"&?",grade:"&?",isManualStatusPosted:"<?",cursor:"@?",hideRubricIcon:"=?",isExternalSubmission:"=?",rubricStateOverride:"@?",displayStacked:"@?"},this.link=(e,t)=>{if(!e.attempt&&!e.grade)throw new Error("An attempt or grade must be included on scope");if(e.attempt&&e.grade)throw new Error("An attempt or grade should be included on scope, not both");if(!e.column)throw new Error("A column must be included on scope");e.displayGradePill=this.$injector.instantiate(I,{scope:e,element:t})}}}E.$inject=["$injector"],a.module(R,[h.N,d.a]).directive("bbDisplayGradePill",["$injector",e=>e.instantiate(E)])},ooAF:function(e,t){e.exports='<div class="grade-color" ng-class="{\'flex-column\': displayGradePill.isStacked}">\n    <div class="wrapping-input-style readonly pill-style {{displayGradePill.colorClass}} {{displayGradePill.cursorClass}}">\n      <div ng-if="!displayGradePill.shouldShowRubricButton()">\n        <span class="grade-input-display grade-ellipsis"><bdi>{{displayGradePill.displayValue}}</bdi></span>\n      </div>\n      <div ng-if="displayGradePill.shouldShowRubricButton()">\n        <a ng-click="displayGradePill.openRubricEvaluation($event)"\n           ng-class="{\'disable-click\': !!disableRubricEvalClick()}"\n           class="grade-rubric-detail"\n           aria-disabled="{{!!disableRubricEvalClick()}}"\n           href=""\n           analytics-id="components.directives.grade.gradePill.showRubric.link">\n          <bb-svg-icon size="small" icon="rubric"></bb-svg-icon>\n          <span class="grade-input-display ready grade-ellipsis">{{displayGradePill.displayValue}}</span>\n        </a>\n      </div>\n    </div>\n    <div ng-if="displayGradePill.shouldShowExempt()" class="left">\n      <span class="exempt-indicator" bb-translate>components.directives.grade.grade-input.exempt</span>\n    </div>\n</div>\n'},rPCE:function(e,t,s){"use strict";var i=s("D57K"),a=s("Llzl"),r=s("0JpG"),o=s("aHpC"),l=s("9hUw"),c=s("H9hP"),n=s("Dr7i"),d=s("NIxw");s.d(t,"a",(function(){return p}));const p="ultra.components.directives.grade.peerReviewStatus";let h=class{constructor(e,t,s){this.scope=e,this.localizeService=t,this.peerService=s,this.peerService.getOrCreatePeerContentFromColumn(this.scope.column).then((e=>this.peerReviewContentObject=e))}get hasPassedPeerReviewPeriod(){return!!this.peerReviewContentObject&&(this.peerReviewContentObject.isAfterPeerReviewWindow&&!this.scope.hasDueDateException)}get hasCompletedAllPeerReviews(){return!!this.peerReviewContentObject&&this.peerReviewContentObject.numOfPeerReviewsToComplete===this.scope.reviewsCompleted}get hasCompletedPeerReviews(){return this.scope.reviewsCompleted>0}get hasStartedPeerReviews(){return this.scope.reviewsStarted>0}get peerReviewActivityLabel(){if(!this.peerReviewContentObject)return null;const e=this.localizeService.getLocale(this.scope),t=this.scope.reviewsCompletedLate>0;return this.hasCompletedAllPeerReviews?!t||this.scope.hasDueDateException?this.localizeService.translateSync({locale:e,key:"course.grades.peerReviewStatus.activity.completed"}):this.localizeService.translateSync({locale:e,key:"course.grades.peerReviewStatus.activity.completedLate",noWrap:!0,noEscape:!0,params:{peerReviewsCompletedLate:this.scope.reviewsCompletedLate}}):this.hasCompletedPeerReviews?!t&&!this.peerReviewContentObject.isAfterPeerReviewWindow||this.scope.hasDueDateException?this.localizeService.translateSync({locale:e,key:"course.grades.peerReviewStatus.activity.partialCompleted",noWrap:!0,noEscape:!0,params:{peerReviewsCompleted:this.scope.reviewsCompleted,peerReviewsPerStudent:this.peerReviewContentObject.numOfPeerReviewsToComplete}}):this.localizeService.translateSync({locale:e,key:"course.grades.peerReviewStatus.activity.partialCompletedLate",noWrap:!0,noEscape:!0,params:{peerReviewsCompleted:this.scope.reviewsCompleted,peerReviewsPerStudent:this.peerReviewContentObject.numOfPeerReviewsToComplete,peerReviewsCompletedLate:this.scope.reviewsCompletedLate}}):this.hasStartedPeerReviews?!this.peerReviewContentObject.isAfterPeerReviewWindow||this.scope.hasDueDateException?this.localizeService.translateSync({locale:e,key:"course.grades.peerReviewStatus.activity.saved"}):this.localizeService.translateSync({locale:e,key:"course.grades.peerReviewStatus.activity.savedLate"}):!this.peerReviewContentObject.isAfterPeerReviewWindow||this.scope.hasDueDateException?this.localizeService.translateSync({locale:e,key:"course.grades.peerReviewStatus.activity.notStarted"}):this.localizeService.translateSync({locale:e,key:"course.grades.peerReviewStatus.activity.notStartedLate"})}get isExempt(){return this.scope.reviewsExempt}get shouldMarkLate(){return!this.scope.hasDueDateException&&(this.scope.reviewsCompletedLate>0||!this.hasCompletedAllPeerReviews&&this.hasPassedPeerReviewPeriod)}};h=Object(i.a)([Object(i.c)(0,Object(o.b)("scope")),Object(i.c)(1,Object(o.b)(r.serviceName)),Object(i.c)(2,Object(o.b)(l.b))],h);let u=class{constructor(e){this.$injector=e,this.restrict="E",this.template=d,this.scope={column:"<",reviewsCompleted:"<",reviewsCompletedLate:"<",reviewsStarted:"<",hasDueDateException:"<",reviewsExempt:"<"},this.link=e=>{e.peerReviewStatus=this.$injector.instantiate(h,{scope:e})}}};u=Object(i.a)([Object(i.c)(0,Object(o.b)("$injector"))],u),a.module(p,[l.a,r.moduleName,c.a,n.a]).directive("bbPeerReviewStatus",["$injector",e=>e.instantiate(u)])}}]);